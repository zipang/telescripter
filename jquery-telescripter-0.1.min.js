/**
 * TeleScripter - a jQuery Plugin
 * @version 0.1
 * @date 2013-11-17
 * @author zipang
 * @url http://github.com/zipang/telescripter
 * @licence MIT
 */(function(e,t){function r(e,n){this.$display=t(e);this.options=n;var r=this.$display.text();r&&!n.source&&(n.source=r.split("\n\n"));n.autostart&&this.start()}var n={autostart:!0,autoloop:!0,prompt:"> ",pageDelay:2500,lineDelay:500,charDelay:150};t.extend(r.prototype,{start:function(){this.rendering&&this.stop().cls();var e=0,t=this,n=t.options.source,r=n.length,i=function(){if(t.rendering){t.printPage(n[e%r],i);e++}};t.rendering=!0;i();return t},cls:function(){this.$renderElt=t("<pre>");this.$display.empty().append(this.$renderElt);this.refreshScreen(this.options.prompt);return this},append:function(e){this.refreshScreen(this.text+e);return this},newline:function(){this.append("\n"+this.options.prompt);return this},refreshScreen:function(e){this.text=e;this.$renderElt.text(e);return this},printPage:function(e,t){this.cls();var n=0,r=this,i=e.split("\n"),s=r.options.lineDelay,o=i.length,u=function(){r.rendering&&(n<o?requestAnimationFrame(function(){n>0&&r.newline();r.rendering=setTimeout(function(){r.printLine(i[n++],u)},s)}):r.rendering=setTimeout(t,r.options.pageDelay))};u();return r},printLine:function(e,t){var n=e.split(""),r=this,i=0,s=n.length,o=r.options.charDelay,u=function(){var e=r.rendering;requestAnimationFrame(function(){if(r.rendering!=e)return;if(i<s){r.refreshScreen(r.text+n[i++]);r.rendering=setTimeout(u,o)}else t()})};u()},stop:function(){clearTimeout(this.rendering);this.rendering=!1;return this}});t.fn.telescripter=function(e){return t(this).each(function(i,s){var o=t.extend({},n,e),u=new r(s,o);t(s).data("telescripter",u).on("start",function(){u.start()}).on("stop",function(){u.stop()})})}})(this,jQuery);